<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ðŸ¦š BPC Animasyon Ãœretici â€¢ MP4</title>
<style>
  * { box-sizing: border-box; }
  body {
    margin:0; background:#000; color:#eee;
    font-family: system-ui, Arial, sans-serif;
    display:flex; flex-direction:column;
    align-items:center; justify-content:center;
    height:100vh; overflow:hidden;
  }
  h1 { font-size:28px; margin:10px 0; }
  .panel { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
  .panel input { padding:6px; border-radius:6px; border:1px solid #444; background:#111; color:#eee; }
  .btn { padding:8px 14px; border-radius:8px; background:#111; border:1px solid #22a2aa; color:#eee; cursor:pointer; }
  .btn:hover { background:#22a2aa33; }
  canvas { width:90vw; max-width:720px; aspect-ratio:1; border-radius:12px; background:#000; }
</style>
</head>
<body>
  <h1>ðŸ¦š BPC KÄ±sa Animasyon Ãœretici</h1>
  <div class="panel">
    <label>BaÅŸlÄ±k <input id="title" type="text" value="BabyPeacock â€¢ BPC"></label>
    <label>SÃ¼re (sn) <input id="dur" type="number" value="6" min="3" max="10"></label>
    <label>Renk 1 <input id="c1" type="color" value="#00ffdd"></label>
    <label>Renk 2 <input id="c2" type="color" value="#7700ff"></label>
    <label>Ã‡Ã¶zÃ¼nÃ¼rlÃ¼k <input id="res" type="number" value="1080"></label>
  </div>
  <div class="panel">
    <button class="btn" id="preview">Ã–nizleme</button>
    <button class="btn" id="record">KaydÄ± Al (MP4)</button>
  </div>
  <canvas id="cv"></canvas>
  <p id="status"></p>
  <a id="dl" style="display:none" class="btn" download>Ä°ndir</a>

<script>
const cv = document.getElementById("cv");
const cx = cv.getContext("2d");
const ui = {
  title: document.getElementById("title"),
  dur: document.getElementById("dur"),
  c1: document.getElementById("c1"),
  c2: document.getElementById("c2"),
  res: document.getElementById("res"),
  status: document.getElementById("status"),
  dl: document.getElementById("dl")
};
let W, H, t = 0, anim, rec;

// --- KuÅŸ Maskotu ---
const logo = new Image();
logo.crossOrigin = "anonymous";
logo.src = "bpc-bird.png"; // gÃ¶rsel deponda olmalÄ±

function resizeCanvas(size = 720) {
  cv.width = size;
  cv.height = size;
  W = cv.width; H = cv.height;
}

function drawFrame(ts) {
  t += 0.016;
  cx.clearRect(0, 0, W, H);

  // Arka plan gradyan dairesi
  const g = cx.createConicGradient(t, W/2, H/2);
  g.addColorStop(0, ui.c1.value);
  g.addColorStop(1, ui.c2.value);
  cx.fillStyle = g;
  cx.beginPath();
  cx.arc(W/2, H/2, W*0.45, 0, Math.PI*2);
  cx.fill();

  // KuÅŸ
  if (logo.complete) {
    const s = W * 0.32;
    const flap = Math.sin(t*4) * 0.05;
    const bob = Math.sin(t*2) * (W*0.01);
    cx.save();
    cx.translate(W/2, H/2 - 20 + bob);
    cx.scale(1 + flap, 1 - flap);
    cx.shadowColor = "rgba(0,255,213,0.3)";
    cx.shadowBlur = W*0.02;
    cx.drawImage(logo, -s/2, -s/2, s, s);
    cx.restore();
  }

  // YazÄ±
  cx.fillStyle = "#fff";
  cx.font = `${W*0.05}px Poppins, sans-serif`;
  cx.textAlign = "center";
  cx.fillText(ui.title.value, W/2, H*0.9);

  anim = requestAnimationFrame(drawFrame);
}

document.getElementById("preview").onclick = () => {
  cancelAnimationFrame(anim);
  resizeCanvas(ui.res.value);
  t = 0;
  drawFrame();
};

// --- KayÄ±t ---
async function record() {
  cancelAnimationFrame(anim);
  resizeCanvas(ui.res.value);
  t = 0;
  const FPS = 60;
  const stream = cv.captureStream(FPS);
  const chunks = [];
  const mime = 'video/mp4';
  const rec = new MediaRecorder(stream, {
    mimeType: mime, videoBitsPerSecond: 8_000_000
  });
  rec.ondataavailable = e => e.data.size && chunks.push(e.data);
  rec.start();

  ui.status.textContent = "Kaydediliyor...";
  const dur = Math.min(Math.max(+ui.dur.value, 3), 10);
  let frames = dur * FPS;
  function loop() {
    if (frames-- > 0) {
      drawFrame();
      requestAnimationFrame(loop);
    } else rec.stop();
  }
  loop();

  rec.onstop = () => {
    const blob = new Blob(chunks, { type: mime });
    const url = URL.createObjectURL(blob);
    ui.dl.href = url;
    ui.dl.download = "bpc-anim.mp4";
    ui.dl.style.display = "inline-block";
    ui.dl.textContent = "ðŸŽ¬ MP4 Ä°ndir";
    ui.status.textContent = "KayÄ±t tamamlandÄ±!";
  };
}

document.getElementById("record").onclick = record;
</script>
</body>
</html>
